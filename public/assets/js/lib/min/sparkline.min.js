!function(a,b,c){!function(d){"function"==typeof define&&define.amd?define(["jquery"],d):jQuery&&!jQuery.fn.sparkline&&d(jQuery)}(function(l){var p,H,u,E,v,n,I,J,x,f,g,K,A,o,t,G,C,j,s,D,h,d,F,w,q,L,e,z,m,B,y,k,r={},i=0;p=function(){return{common:{type:"line",lineColor:"#00f",fillColor:"#cdf",defaultPixelsPerValue:3,width:"auto",height:"auto",composite:!1,tagValuesAttribute:"values",tagOptionsPrefix:"spark",enableTagOptions:!1,enableHighlight:!0,highlightLighten:1.4,tooltipSkipNull:!0,tooltipPrefix:"",tooltipSuffix:"",disableHiddenCheck:!1,numberFormatter:!1,numberDigitGroupCount:3,numberDigitGroupSep:",",numberDecimalMark:".",disableTooltips:!1,disableInteraction:!1},line:{spotColor:"#f80",highlightSpotColor:"#5f5",highlightLineColor:"#f22",spotRadius:1.5,minSpotColor:"#f80",maxSpotColor:"#f80",lineWidth:1,normalRangeMin:c,normalRangeMax:c,normalRangeColor:"#ccc",drawNormalOnTop:!1,chartRangeMin:c,chartRangeMax:c,chartRangeMinX:c,chartRangeMaxX:c,tooltipFormat:new u('<span style="color: {{color}}">&#9679;</span> {{prefix}}{{y}}{{suffix}}')},bar:{barColor:"#3366cc",negBarColor:"#f44",stackedBarColor:["#3366cc","#dc3912","#ff9900","#109618","#66aa00","#dd4477","#0099c6","#990099"],zeroColor:c,nullColor:c,zeroAxis:!0,barWidth:4,barSpacing:1,chartRangeMax:c,chartRangeMin:c,chartRangeClip:!1,colorMap:c,tooltipFormat:new u('<span style="color: {{color}}">&#9679;</span> {{prefix}}{{value}}{{suffix}}')},tristate:{barWidth:4,barSpacing:1,posBarColor:"#6f6",negBarColor:"#f44",zeroBarColor:"#999",colorMap:{},tooltipFormat:new u('<span style="color: {{color}}">&#9679;</span> {{value:map}}'),tooltipValueLookups:{map:{"-1":"Loss",0:"Draw",1:"Win"}}},discrete:{lineHeight:"auto",thresholdColor:c,thresholdValue:0,chartRangeMax:c,chartRangeMin:c,chartRangeClip:!1,tooltipFormat:new u("{{prefix}}{{value}}{{suffix}}")},bullet:{targetColor:"#f33",targetWidth:3,performanceColor:"#33f",rangeColors:["#d3dafe","#a8b6ff","#7f94ff"],base:c,tooltipFormat:new u("{{fieldkey:fields}} - {{value}}"),tooltipValueLookups:{fields:{r:"Range",p:"Performance",t:"Target"}}},pie:{offset:0,sliceColors:["#3366cc","#dc3912","#ff9900","#109618","#66aa00","#dd4477","#0099c6","#990099"],borderWidth:0,borderColor:"#000",tooltipFormat:new u('<span style="color: {{color}}">&#9679;</span> {{value}} ({{percent.1}}%)')},box:{raw:!1,boxLineColor:"#000",boxFillColor:"#cdf",whiskerColor:"#000",outlierLineColor:"#333",outlierFillColor:"#fff",medianColor:"#f00",showOutliers:!0,outlierIQR:1.5,spotRadius:1.5,target:c,targetColor:"#4a2",chartRangeMax:c,chartRangeMin:c,tooltipFormat:new u("{{field:fields}}: {{value}}"),tooltipFormatFieldlistKey:"field",tooltipValueLookups:{fields:{lq:"Lower Quartile",med:"Median",uq:"Upper Quartile",lo:"Left Outlier",ro:"Right Outlier",lw:"Left Whisker",rw:"Right Whisker"}}}}},L='.jqstooltip { position: absolute;left: 0px;top: 0px;visibility: hidden;background: rgb(0, 0, 0) transparent;background-color: rgba(0,0,0,0.6);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000);-ms-filter: "progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000)";color: white;font: 10px arial, san serif;text-align: left;white-space: nowrap;padding: 5px;border: 1px solid white;z-index: 10000;}.jqsfield { color: white;font: 10px arial, san serif;text-align: left;}',H=function(){var M,N;return M=function(){this.init.apply(this,arguments)},arguments.length>1?(arguments[0]?(M.prototype=l.extend(new arguments[0],arguments[arguments.length-1]),M._super=arguments[0].prototype):M.prototype=arguments[arguments.length-1],arguments.length>2&&(N=Array.prototype.slice.call(arguments,1,-1),N.unshift(M.prototype),l.extend.apply(l,N))):M.prototype=arguments[0],M.prototype.cls=M,M},l.SPFormatClass=u=H({fre:/\{\{([\w.]+?)(:(.+?))?\}\}/g,precre:/(\w+)\.(\d+)/,init:function(N,M){this.format=N,this.fclass=M},render:function(U,S,V){var Q,N,O,P,M,T=this,R=U;return this.format.replace(this.fre,function(){var W;return N=arguments[1],O=arguments[3],Q=T.precre.exec(N),Q?(M=Q[2],N=Q[1]):M=!1,P=R[N],P===c?"":O&&S&&S[O]?(W=S[O],W.get?S[O].get(P)||P:S[O][P]||P):(x(P)&&(P=V.get("numberFormatter")?V.get("numberFormatter")(P):o(P,M,V.get("numberDigitGroupCount"),V.get("numberDigitGroupSep"),V.get("numberDecimalMark"))),P)})}}),l.spformat=function(N,M){return new u(N,M)},E=function(O,N,M){return N>O?N:O>M?M:O},v=function(M,O){var N;return 2===O?(N=b.floor(M.length/2),M.length%2?M[N]:(M[N-1]+M[N])/2):M.length%2?(N=(M.length*O+O)/4,N%1?(M[b.floor(N)]+M[b.floor(N)-1])/2:M[N-1]):(N=(M.length*O+2)/4,N%1?(M[b.floor(N)]+M[b.floor(N)-1])/2:M[N-1])},n=function(N){var M;switch(N){case"undefined":N=c;break;case"null":N=null;break;case"true":N=!0;break;case"false":N=!1;break;default:M=parseFloat(N),N==M&&(N=M)}return N},I=function(O){var N,M=[];for(N=O.length;N--;){M[N]=n(O[N])}return M},J=function(Q,O){var N,P,M=[];for(N=0,P=Q.length;P>N;N++){Q[N]!==O&&M.push(Q[N])}return M},x=function(M){return !isNaN(parseFloat(M))&&isFinite(M)},o=function(O,N,M,R,Q){var S,P;for(O=(N===!1?parseFloat(O).toString():O.toFixed(N)).split(""),S=(S=l.inArray(".",O))<0?O.length:S,S<O.length&&(O[S]=Q),P=S-M;P>0;P-=M){O.splice(P,0,R)}return O.join("")},f=function(P,N,M){var O;for(O=N.length;O--;){if((!M||null!==N[O])&&N[O]!==P){return !1}}return !0},g=function(O){var M,N=0;for(M=O.length;M--;){N+="number"==typeof O[M]?O[M]:0}return N},A=function(M){return l.isArray(M)?M:[M]},K=function(N){var M;a.createStyleSheet?a.createStyleSheet().cssText=N:(M=a.createElement("style"),M.type="text/css",a.getElementsByTagName("head")[0].appendChild(M),M["string"==typeof a.body.style.WebkitAppearance?"innerText":"innerHTML"]=N)},l.fn.simpledraw=function(Q,M,N,P){var S,R;if(N&&(S=this.data("_jqs_vcanvas"))){return S}if(l.fn.sparkline.canvas===!1){return !1}if(l.fn.sparkline.canvas===c){var O=a.createElement("canvas");if(O.getContext&&O.getContext("2d")){l.fn.sparkline.canvas=function(V,T,W,U){return new B(V,T,W,U)}}else{if(!a.namespaces||a.namespaces.v){return l.fn.sparkline.canvas=!1,!1}a.namespaces.add("v","urn:schemas-microsoft-com:vml","#default#VML"),l.fn.sparkline.canvas=function(U,T,V){return new y(U,T,V)}}}return Q===c&&(Q=l(this).innerWidth()),M===c&&(M=l(this).innerHeight()),S=l.fn.sparkline.canvas(Q,M,this,P),R=l(this).data("_jqs_mhandler"),R&&R.registerCanvas(S),S},l.fn.cleardraw=function(){var M=this.data("_jqs_vcanvas");M&&M.reset()},l.RangeMapClass=t=H({init:function(P){var O,M,N=[];for(O in P){P.hasOwnProperty(O)&&"string"==typeof O&&O.indexOf(":")>-1&&(M=O.split(":"),M[0]=0===M[0].length?-1/0:parseFloat(M[0]),M[1]=0===M[1].length?1/0:parseFloat(M[1]),M[2]=P[O],N.push(M))}this.map=P,this.rangelist=N||!1},get:function(Q){var P,N,M,O=this.rangelist;if((M=this.map[Q])!==c){return M}if(O){for(P=O.length;P--;){if(N=O[P],N[0]<=Q&&N[1]>=Q){return N[2]}}}return c}}),l.range_map=function(M){return new t(M)},G=H({init:function(O,M){var N=l(O);this.$el=N,this.options=M,this.currentPageX=0,this.currentPageY=0,this.el=O,this.splist=[],this.tooltip=null,this.over=!1,this.displayTooltips=!M.get("disableTooltips"),this.highlightEnabled=!M.get("disableHighlight")},registerSparkline:function(M){this.splist.push(M),this.over&&this.updateDisplay()},registerCanvas:function(M){var N=l(M.canvas);this.canvas=M,this.$canvas=N,N.mouseenter(l.proxy(this.mouseenter,this)),N.mouseleave(l.proxy(this.mouseleave,this)),N.click(l.proxy(this.mouseclick,this))},reset:function(M){this.splist=[],this.tooltip&&M&&(this.tooltip.remove(),this.tooltip=c)},mouseclick:function(N){var M=l.Event("sparklineClick");M.originalEvent=N,M.sparklines=this.splist,this.$el.trigger(M)},mouseenter:function(M){l(a.body).unbind("mousemove.jqs"),l(a.body).bind("mousemove.jqs",l.proxy(this.mousemove,this)),this.over=!0,this.currentPageX=M.pageX,this.currentPageY=M.pageY,this.currentEl=M.target,!this.tooltip&&this.displayTooltips&&(this.tooltip=new C(this.options),this.tooltip.updatePosition(M.pageX,M.pageY)),this.updateDisplay()},mouseleave:function(){l(a.body).unbind("mousemove.jqs");var Q,O,P=this.splist,M=P.length,N=!1;for(this.over=!1,this.currentEl=null,this.tooltip&&(this.tooltip.remove(),this.tooltip=null),O=0;M>O;O++){Q=P[O],Q.clearRegionHighlight()&&(N=!0)}N&&this.canvas.render()},mousemove:function(M){this.currentPageX=M.pageX,this.currentPageY=M.pageY,this.currentEl=M.target,this.tooltip&&this.tooltip.updatePosition(M.pageX,M.pageY),this.updateDisplay()},updateDisplay:function(){var U,M,S,W,V,N=this.splist,T=N.length,R=!1,Q=this.$canvas.offset(),P=this.currentPageX-Q.left,O=this.currentPageY-Q.top;if(this.over){for(S=0;T>S;S++){M=N[S],W=M.setRegionHighlight(this.currentEl,P,O),W&&(R=!0)}if(R){if(V=l.Event("sparklineRegionChange"),V.sparklines=this.splist,this.$el.trigger(V),this.tooltip){for(U="",S=0;T>S;S++){M=N[S],U+=M.getCurrentRegionTooltip()}this.tooltip.setContent(U)}this.disableHighlight||this.canvas.render()}null===W&&this.mouseleave()}}}),C=H({sizeStyle:"position: static !important;display: block !important;visibility: hidden !important;float: left !important;",init:function(M){var P,O=M.get("tooltipClassname","jqstooltip"),N=this.sizeStyle;this.container=M.get("tooltipContainer")||a.body,this.tooltipOffsetX=M.get("tooltipOffsetX",10),this.tooltipOffsetY=M.get("tooltipOffsetY",12),l("#jqssizetip").remove(),l("#jqstooltip").remove(),this.sizetip=l("<div/>",{id:"jqssizetip",style:N,"class":O}),this.tooltip=l("<div/>",{id:"jqstooltip","class":O}).appendTo(this.container),P=this.tooltip.offset(),this.offsetLeft=P.left,this.offsetTop=P.top,this.hidden=!0,l(window).unbind("resize.jqs scroll.jqs"),l(window).bind("resize.jqs scroll.jqs",l.proxy(this.updateWindowDims,this)),this.updateWindowDims()},updateWindowDims:function(){this.scrollTop=l(window).scrollTop(),this.scrollLeft=l(window).scrollLeft(),this.scrollRight=this.scrollLeft+l(window).width(),this.updatePosition()},getSize:function(M){this.sizetip.html(M).appendTo(this.container),this.width=this.sizetip.width()+1,this.height=this.sizetip.height(),this.sizetip.remove()},setContent:function(M){return M?(this.getSize(M),this.tooltip.html(M).css({width:this.width,height:this.height,visibility:"visible"}),this.hidden&&(this.hidden=!1,this.updatePosition()),void 0):(this.tooltip.css("visibility","hidden"),this.hidden=!0,void 0)},updatePosition:function(M,N){if(M===c){if(this.mousex===c){return}M=this.mousex-this.offsetLeft,N=this.mousey-this.offsetTop}else{this.mousex=M-=this.offsetLeft,this.mousey=N-=this.offsetTop}this.height&&this.width&&!this.hidden&&(N-=this.height+this.tooltipOffsetY,M+=this.tooltipOffsetX,N<this.scrollTop&&(N=this.scrollTop),M<this.scrollLeft?M=this.scrollLeft:M+this.width>this.scrollRight&&(M=this.scrollRight-this.width),this.tooltip.css({left:M,top:N}))},remove:function(){this.tooltip.remove(),this.sizetip.remove(),this.sizetip=this.tooltip=c,l(window).unbind("resize.jqs scroll.jqs")}}),e=function(){K(L)},l(e),k=[],l.fn.sparkline=function(M,N){return this.each(function(){var Q,P,O=new l.fn.sparkline.options(this,N),R=l(this);if(Q=function(){var T,V,S,U,Y,X,W;return"html"===M||M===c?(W=this.getAttribute(O.get("tagValuesAttribute")),(W===c||null===W)&&(W=R.html()),T=W.replace(/(^\s*<!--)|(-->\s*$)|\s+/g,"").split(",")):T=M,V="auto"===O.get("width")?T.length*O.get("defaultPixelsPerValue"):O.get("width"),"auto"===O.get("height")?O.get("composite")&&l.data(this,"_jqs_vcanvas")||(U=a.createElement("span"),U.innerHTML="a",R.html(U),S=l(U).innerHeight()||l(U).height(),l(U).remove(),U=null):S=O.get("height"),O.get("disableInteraction")?Y=!1:(Y=l.data(this,"_jqs_mhandler"),Y?O.get("composite")||Y.reset():(Y=new G(this,O),l.data(this,"_jqs_mhandler",Y))),O.get("composite")&&!l.data(this,"_jqs_vcanvas")?(l.data(this,"_jqs_errnotify")||(alert("Attempted to attach a composite sparkline to an element with no existing sparkline"),l.data(this,"_jqs_errnotify",!0)),void 0):(X=new (l.fn.sparkline[O.get("type")])(this,T,O,V,S),X.render(),Y&&Y.registerSparkline(X),void 0)},l(this).html()&&!O.get("disableHiddenCheck")&&l(this).is(":hidden")||!l(this).parents("body").length){if(!O.get("composite")&&l.data(this,"_jqs_pending")){for(P=k.length;P;P--){k[P-1][0]==this&&k.splice(P-1,1)}}k.push([this,Q]),l.data(this,"_jqs_pending",!0)}else{Q.call(this)}})},l.fn.sparkline.defaults=p(),l.sparkline_display_visible=function(){var P,N,O,M=[];for(N=0,O=k.length;O>N;N++){P=k[N][0],l(P).is(":visible")&&!l(P).parents().is(":hidden")?(k[N][1].call(P),l.data(k[N][0],"_jqs_pending",!1),M.push(N)):l(P).closest("html").length||l.data(P,"_jqs_pending")||(l.data(k[N][0],"_jqs_pending",!1),M.push(N))}for(N=M.length;N;N--){k.splice(M[N-1],1)}},l.fn.sparkline.options=H({init:function(M,R){var Q,P,O,N;this.userOptions=R=R||{},this.tag=M,this.tagValCache={},P=l.fn.sparkline.defaults,O=P.common,this.tagOptionsPrefix=R.enableTagOptions&&(R.tagOptionsPrefix||O.tagOptionsPrefix),N=this.getTagSetting("type"),Q=N===r?P[R.type||O.type]:P[N],this.mergedOptions=l.extend({},O,Q,R)},getTagSetting:function(O){var R,N,Q,M,P=this.tagOptionsPrefix;if(P===!1||P===c){return r}if(this.tagValCache.hasOwnProperty(O)){R=this.tagValCache.key}else{if(R=this.tag.getAttribute(P+O),R===c||null===R){R=r}else{if("["===R.substr(0,1)){for(R=R.substr(1,R.length-2).split(","),N=R.length;N--;){R[N]=n(R[N].replace(/(^\s*)|(\s*$)/g,""))}}else{if("{"===R.substr(0,1)){for(Q=R.substr(1,R.length-2).split(","),R={},N=Q.length;N--;){M=Q[N].split(":",2),R[M[0].replace(/(^\s*)|(\s*$)/g,"")]=n(M[1].replace(/(^\s*)|(\s*$)/g,""))}}else{R=n(R)}}}this.tagValCache.key=R}return R},get:function(P,O){var M,N=this.getTagSetting(P);return N!==r?N:(M=this.mergedOptions[P])===c?O:M}}),l.fn.sparkline._base=H({disabled:!1,init:function(Q,N,O,P,M){this.el=Q,this.$el=l(Q),this.values=N,this.options=O,this.width=P,this.height=M,this.currentRegion=c},initTarget:function(){var M=!this.options.get("disableInteraction");(this.target=this.$el.simpledraw(this.width,this.height,this.options.get("composite"),M))?(this.canvasWidth=this.target.pixelWidth,this.canvasHeight=this.target.pixelHeight):this.disabled=!0},render:function(){return this.disabled?(this.el.innerHTML="",!1):!0},getRegion:function(){},setRegionHighlight:function(O,M,R){var Q,P=this.currentRegion,N=!this.options.get("disableHighlight");return M>this.canvasWidth||R>this.canvasHeight||0>M||0>R?null:(Q=this.getRegion(O,M,R),P!==Q?(P!==c&&N&&this.removeHighlight(),this.currentRegion=Q,Q!==c&&N&&this.renderHighlight(),!0):!1)},clearRegionHighlight:function(){return this.currentRegion!==c?(this.removeHighlight(),this.currentRegion=c,!0):!1},renderHighlight:function(){this.changeHighlight(!0)},removeHighlight:function(){this.changeHighlight(!1)},changeHighlight:function(){},getCurrentRegionTooltip:function(){var T,Y,M,V,ab,P,U,Q,W,O,aa,Z,X,N,ac=this.options,S="",R=[];if(this.currentRegion===c){return""}if(T=this.getCurrentRegionFields(),aa=ac.get("tooltipFormatter")){return aa(this,ac,T)}if(ac.get("tooltipChartTitle")&&(S+='<div class="jqs jqstitle">'+ac.get("tooltipChartTitle")+"</div>\n"),Y=this.options.get("tooltipFormat"),!Y){return""}if(l.isArray(Y)||(Y=[Y]),l.isArray(T)||(T=[T]),U=this.options.get("tooltipFormatFieldlist"),Q=this.options.get("tooltipFormatFieldlistKey"),U&&Q){for(W=[],P=T.length;P--;){O=T[P][Q],-1!=(N=l.inArray(O,U))&&(W[N]=T[P])}T=W}for(M=Y.length,X=T.length,P=0;M>P;P++){for(Z=Y[P],"string"==typeof Z&&(Z=new u(Z)),V=Z.fclass||"jqsfield",N=0;X>N;N++){T[N].isNull&&ac.get("tooltipSkipNull")||(l.extend(T[N],{prefix:ac.get("tooltipPrefix"),suffix:ac.get("tooltipSuffix")}),ab=Z.render(T[N],ac.get("tooltipValueLookups"),ac),R.push('<div class="'+V+'">'+ab+"</div>"))}}return R.length?S+R.join("\n"):""},getCurrentRegionFields:function(){},calcHighlightColor:function(M,N){var S,R,Q,P,T=N.get("highlightColor"),O=N.get("highlightLighten");if(T){return T}if(O&&(S=/^#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(M)||/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(M))){for(Q=[],R=4===M.length?16:1,P=0;3>P;P++){Q[P]=E(b.round(parseInt(S[P+1],16)*R*O),0,255)}return"rgb("+Q.join(",")+")"}return M}}),j={changeHighlight:function(O){var N,Q=this.currentRegion,P=this.target,M=this.regionShapes[Q];M&&(N=this.renderRegion(Q,O),l.isArray(N)||l.isArray(M)?(P.replaceWithShapes(M,N),this.regionShapes[Q]=l.map(N,function(R){return R.id})):(P.replaceWithShape(M,N),this.regionShapes[Q]=N.id))},render:function(){var M,Q,P,O,N=this.values,R=this.target,S=this.regionShapes;if(this.cls._super.render.call(this)){for(P=N.length;P--;){if(M=this.renderRegion(P)){if(l.isArray(M)){for(Q=[],O=M.length;O--;){M[O].append(),Q.push(M[O].id)}S[P]=Q}else{M.append(),S[P]=M.id}}else{S[P]=null}}R.render()}}},l.fn.sparkline.line=s=H(l.fn.sparkline._base,{type:"line",init:function(Q,N,O,P,M){s._super.init.call(this,Q,N,O,P,M),this.vertices=[],this.regionMap=[],this.xvalues=[],this.yvalues=[],this.yminmax=[],this.hightlightSpotId=null,this.lastShapeId=null,this.initTarget()},getRegion:function(O,M){var N,P=this.regionMap;for(N=P.length;N--;){if(null!==P[N]&&M>=P[N][0]&&M<=P[N][1]){return P[N][2]}}return c},getCurrentRegionFields:function(){var M=this.currentRegion;return{isNull:null===this.yvalues[M],x:this.xvalues[M],y:this.yvalues[M],color:this.options.get("lineColor"),fillColor:this.options.get("fillColor"),offset:M}},renderHighlight:function(){var N,S,M=this.currentRegion,T=this.target,Q=this.vertices[M],U=this.options,P=U.get("spotRadius"),O=U.get("highlightSpotColor"),R=U.get("highlightLineColor");Q&&(P&&O&&(N=T.drawCircle(Q[0],Q[1],P,c,O),this.highlightSpotId=N.id,T.insertAfterShape(this.lastShapeId,N)),R&&(S=T.drawLine(Q[0],this.canvasTop,Q[0],this.canvasTop+this.canvasHeight,R),this.highlightLineId=S.id,T.insertAfterShape(this.lastShapeId,S)))},removeHighlight:function(){var M=this.target;this.highlightSpotId&&(M.removeShapeId(this.highlightSpotId),this.highlightSpotId=null),this.highlightLineId&&(M.removeShapeId(this.highlightLineId),this.highlightLineId=null)},scanValues:function(){var Q,P,T,S,N,U=this.values,O=U.length,M=this.xvalues,R=this.yvalues,V=this.yminmax;for(Q=0;O>Q;Q++){P=U[Q],T="string"==typeof U[Q],S="object"==typeof U[Q]&&U[Q] instanceof Array,N=T&&U[Q].split(":"),T&&2===N.length?(M.push(Number(N[0])),R.push(Number(N[1])),V.push(Number(N[1]))):S?(M.push(P[0]),R.push(P[1]),V.push(P[1])):(M.push(Q),null===U[Q]||"null"===U[Q]?R.push(null):(R.push(Number(P)),V.push(Number(P))))}this.options.get("xvalues")&&(M=this.options.get("xvalues")),this.maxy=this.maxyorg=b.max.apply(b,V),this.miny=this.minyorg=b.min.apply(b,V),this.maxx=b.max.apply(b,M),this.minx=b.min.apply(b,M),this.xvalues=M,this.yvalues=R,this.yminmax=V},processRangeOptions:function(){var N=this.options,M=N.get("normalRangeMin"),O=N.get("normalRangeMax");M!==c&&(M<this.miny&&(this.miny=M),O>this.maxy&&(this.maxy=O)),N.get("chartRangeMin")!==c&&(N.get("chartRangeClip")||N.get("chartRangeMin")<this.miny)&&(this.miny=N.get("chartRangeMin")),N.get("chartRangeMax")!==c&&(N.get("chartRangeClip")||N.get("chartRangeMax")>this.maxy)&&(this.maxy=N.get("chartRangeMax")),N.get("chartRangeMinX")!==c&&(N.get("chartRangeClipX")||N.get("chartRangeMinX")<this.minx)&&(this.minx=N.get("chartRangeMinX")),N.get("chartRangeMaxX")!==c&&(N.get("chartRangeClipX")||N.get("chartRangeMaxX")>this.maxx)&&(this.maxx=N.get("chartRangeMaxX"))},drawNormalRange:function(O,S,R,P,T){var M=this.options.get("normalRangeMin"),Q=this.options.get("normalRangeMax"),N=S+b.round(R-R*((Q-this.miny)/T)),U=b.round(R*(Q-M)/T);this.target.drawRect(O,N,P,U,c,this.options.get("normalRangeColor")).append()},render:function(){var O,N,ah,al,aj,am,ad,af,aa,Z,ag,Q,ao,Y,ae,ap,S,T,ab,M,W,ai,X,V,ak,R=this.options,aq=this.target,an=this.canvasWidth,P=this.canvasHeight,U=this.vertices,ar=R.get("spotRadius"),ac=this.regionMap;if(s._super.render.call(this)&&(this.scanValues(),this.processRangeOptions(),X=this.xvalues,V=this.yvalues,this.yminmax.length&&!(this.yvalues.length<2))){for(al=aj=0,O=this.maxx-this.minx===0?1:this.maxx-this.minx,N=this.maxy-this.miny===0?1:this.maxy-this.miny,ah=this.yvalues.length-1,ar&&(4*ar>an||4*ar>P)&&(ar=0),ar&&(W=R.get("highlightSpotColor")&&!R.get("disableInteraction"),(W||R.get("minSpotColor")||R.get("spotColor")&&V[ah]===this.miny)&&(P-=b.ceil(ar)),(W||R.get("maxSpotColor")||R.get("spotColor")&&V[ah]===this.maxy)&&(P-=b.ceil(ar),al+=b.ceil(ar)),(W||(R.get("minSpotColor")||R.get("maxSpotColor"))&&(V[0]===this.miny||V[0]===this.maxy))&&(aj+=b.ceil(ar),an-=b.ceil(ar)),(W||R.get("spotColor")||R.get("minSpotColor")||R.get("maxSpotColor")&&(V[ah]===this.miny||V[ah]===this.maxy))&&(an-=b.ceil(ar))),P--,R.get("normalRangeMin")===c||R.get("drawNormalOnTop")||this.drawNormalRange(aj,al,P,an,N),ad=[],af=[ad],Y=ae=null,ap=V.length,ak=0;ap>ak;ak++){aa=X[ak],ag=X[ak+1],Z=V[ak],Q=aj+b.round((aa-this.minx)*(an/O)),ao=ap-1>ak?aj+b.round((ag-this.minx)*(an/O)):an,ae=Q+(ao-Q)/2,ac[ak]=[Y||0,ae,ak],Y=ae,null===Z?ak&&(null!==V[ak-1]&&(ad=[],af.push(ad)),U.push(null)):(Z<this.miny&&(Z=this.miny),Z>this.maxy&&(Z=this.maxy),ad.length||ad.push([Q,al+P]),am=[Q,al+b.round(P-P*((Z-this.miny)/N))],ad.push(am),U.push(am))}for(S=[],T=[],ab=af.length,ak=0;ab>ak;ak++){ad=af[ak],ad.length&&(R.get("fillColor")&&(ad.push([ad[ad.length-1][0],al+P]),T.push(ad.slice(0)),ad.pop()),ad.length>2&&(ad[0]=[ad[0][0],ad[1][1]]),S.push(ad))}for(ab=T.length,ak=0;ab>ak;ak++){aq.drawShape(T[ak],R.get("fillColor"),R.get("fillColor")).append()}for(R.get("normalRangeMin")!==c&&R.get("drawNormalOnTop")&&this.drawNormalRange(aj,al,P,an,N),ab=S.length,ak=0;ab>ak;ak++){aq.drawShape(S[ak],R.get("lineColor"),c,R.get("lineWidth")).append()}if(ar&&R.get("valueSpots")){for(M=R.get("valueSpots"),M.get===c&&(M=new t(M)),ak=0;ap>ak;ak++){ai=M.get(V[ak]),ai&&aq.drawCircle(aj+b.round((X[ak]-this.minx)*(an/O)),al+b.round(P-P*((V[ak]-this.miny)/N)),ar,c,ai).append()}}ar&&R.get("spotColor")&&null!==V[ah]&&aq.drawCircle(aj+b.round((X[X.length-1]-this.minx)*(an/O)),al+b.round(P-P*((V[ah]-this.miny)/N)),ar,c,R.get("spotColor")).append(),this.maxy!==this.minyorg&&(ar&&R.get("minSpotColor")&&(aa=X[l.inArray(this.minyorg,V)],aq.drawCircle(aj+b.round((aa-this.minx)*(an/O)),al+b.round(P-P*((this.minyorg-this.miny)/N)),ar,c,R.get("minSpotColor")).append()),ar&&R.get("maxSpotColor")&&(aa=X[l.inArray(this.maxyorg,V)],aq.drawCircle(aj+b.round((aa-this.minx)*(an/O)),al+b.round(P-P*((this.maxyorg-this.miny)/N)),ar,c,R.get("maxSpotColor")).append())),this.lastShapeId=aq.getLastShapeId(),this.canvasTop=al,aq.render()}}}),l.fn.sparkline.bar=D=H(l.fn.sparkline._base,j,{type:"bar",init:function(at,av,aa,M,N){var aw,T,ak,ab,aj,ar,al,R,ag,Y,au,Z,aq,X,an,Q,ap,ah,U,ad,O,ao,ac=parseInt(aa.get("barWidth"),10),ae=parseInt(aa.get("barSpacing"),10),S=aa.get("chartRangeMin"),ai=aa.get("chartRangeMax"),P=aa.get("chartRangeClip"),am=1/0,W=-1/0;for(D._super.init.call(this,at,av,aa,M,N),ar=0,al=av.length;al>ar;ar++){ad=av[ar],aw="string"==typeof ad&&ad.indexOf(":")>-1,(aw||l.isArray(ad))&&(an=!0,aw&&(ad=av[ar]=I(ad.split(":"))),ad=J(ad,null),T=b.min.apply(b,ad),ak=b.max.apply(b,ad),am>T&&(am=T),ak>W&&(W=ak))}this.stacked=an,this.regionShapes={},this.barWidth=ac,this.barSpacing=ae,this.totalBarWidth=ac+ae,this.width=M=av.length*ac+(av.length-1)*ae,this.initTarget(),P&&(aq=S===c?-1/0:S,X=ai===c?1/0:ai),aj=[],ab=an?[]:aj;var af=[],V=[];for(ar=0,al=av.length;al>ar;ar++){if(an){for(Q=av[ar],av[ar]=U=[],af[ar]=0,ab[ar]=V[ar]=0,ap=0,ah=Q.length;ah>ap;ap++){ad=U[ap]=P?E(Q[ap],aq,X):Q[ap],null!==ad&&(ad>0&&(af[ar]+=ad),0>am&&W>0?0>ad?V[ar]+=b.abs(ad):ab[ar]+=ad:ab[ar]+=b.abs(ad-(0>ad?W:am)),aj.push(ad))}}else{ad=P?E(av[ar],aq,X):av[ar],ad=av[ar]=n(ad),null!==ad&&aj.push(ad)}}this.max=Z=b.max.apply(b,aj),this.min=au=b.min.apply(b,aj),this.stackMax=W=an?b.max.apply(b,af):Z,this.stackMin=am=an?b.min.apply(b,aj):au,aa.get("chartRangeMin")!==c&&(aa.get("chartRangeClip")||aa.get("chartRangeMin")<au)&&(au=aa.get("chartRangeMin")),aa.get("chartRangeMax")!==c&&(aa.get("chartRangeClip")||aa.get("chartRangeMax")>Z)&&(Z=aa.get("chartRangeMax")),this.zeroAxis=ag=aa.get("zeroAxis",!0),Y=0>=au&&Z>=0&&ag?0:0==ag?au:au>0?au:Z,this.xaxisOffset=Y,R=an?b.max.apply(b,ab)+b.max.apply(b,V):Z-au,this.canvasHeightEf=ag&&0>au?this.canvasHeight-2:this.canvasHeight-1,Y>au?(ao=an&&Z>=0?W:Z,O=(ao-Y)/R*this.canvasHeight,O!==b.ceil(O)&&(this.canvasHeightEf-=2,O=b.ceil(O))):O=this.canvasHeight,this.yoffset=O,l.isArray(aa.get("colorMap"))?(this.colorMapByIndex=aa.get("colorMap"),this.colorMapByValue=null):(this.colorMapByIndex=null,this.colorMapByValue=aa.get("colorMap"),this.colorMapByValue&&this.colorMapByValue.get===c&&(this.colorMapByValue=new t(this.colorMapByValue))),this.range=R},getRegion:function(O,N){var M=b.floor(N/this.totalBarWidth);return 0>M||M>=this.values.length?c:M},getCurrentRegionFields:function(){var P,O,Q=this.currentRegion,N=A(this.values[Q]),M=[];for(O=N.length;O--;){P=N[O],M.push({isNull:null===P,value:P,color:this.calcColor(O,P,Q),offset:Q})}return M},calcColor:function(Q,R,S){var M,P,T=this.colorMapByIndex,O=this.colorMapByValue,N=this.options;return M=this.stacked?N.get("stackedBarColor"):0>R?N.get("negBarColor"):N.get("barColor"),0===R&&N.get("zeroColor")!==c&&(M=N.get("zeroColor")),O&&(P=O.get(R))?M=P:T&&T.length>S&&(M=T[S]),l.isArray(M)?M[Q%M.length]:M},renderRegion:function(W,Q){var S,aa,ac,ab,R,ad,P,ah,ae,Y,X=this.values[W],O=this.options,M=this.xaxisOffset,V=[],Z=this.range,af=this.stacked,ag=this.target,T=W*this.totalBarWidth,N=this.canvasHeightEf,U=this.yoffset;if(X=l.isArray(X)?X:[X],P=X.length,ah=X[0],ab=f(null,X),Y=f(M,X,!0),ab){return O.get("nullColor")?(ac=Q?O.get("nullColor"):this.calcHighlightColor(O.get("nullColor"),O),S=U>0?U-1:U,ag.drawRect(T,S,this.barWidth-1,0,ac,ac)):c}for(R=U,ad=0;P>ad;ad++){if(ah=X[ad],af&&ah===M){if(!Y||ae){continue}ae=!0}aa=Z>0?b.floor(N*(b.abs(ah-M)/Z))+1:1,M>ah||ah===M&&0===U?(S=R,R+=aa):(S=U-aa,U-=aa),ac=this.calcColor(ad,ah,W),Q&&(ac=this.calcHighlightColor(ac,O)),V.push(ag.drawRect(T,S,this.barWidth-1,aa-1,ac,ac))}return 1===V.length?V[0]:V}}),l.fn.sparkline.tristate=h=H(l.fn.sparkline._base,j,{type:"tristate",init:function(R,N,O,Q,M){var P=parseInt(O.get("barWidth"),10),S=parseInt(O.get("barSpacing"),10);h._super.init.call(this,R,N,O,Q,M),this.regionShapes={},this.barWidth=P,this.barSpacing=S,this.totalBarWidth=P+S,this.values=l.map(N,Number),this.width=Q=N.length*P+(N.length-1)*S,l.isArray(O.get("colorMap"))?(this.colorMapByIndex=O.get("colorMap"),this.colorMapByValue=null):(this.colorMapByIndex=null,this.colorMapByValue=O.get("colorMap"),this.colorMapByValue&&this.colorMapByValue.get===c&&(this.colorMapByValue=new t(this.colorMapByValue))),this.initTarget()},getRegion:function(N,M){return b.floor(M/this.totalBarWidth)},getCurrentRegionFields:function(){var M=this.currentRegion;return{isNull:this.values[M]===c,value:this.values[M],color:this.calcColor(this.values[M],M),offset:M}},calcColor:function(R,S){var N,Q,M=this.values,P=this.options,T=this.colorMapByIndex,O=this.colorMapByValue;return N=O&&(Q=O.get(R))?Q:T&&T.length>S?T[S]:M[S]<0?P.get("negBarColor"):M[S]>0?P.get("posBarColor"):P.get("zeroBarColor")},renderRegion:function(P,M){var O,V,R,T,S,N,U=this.values,W=this.options,Q=this.target;return O=Q.pixelHeight,R=b.round(O/2),T=P*this.totalBarWidth,U[P]<0?(S=R,V=R-1):U[P]>0?(S=0,V=R-1):(S=R-1,V=2),N=this.calcColor(U[P],P),null!==N?(M&&(N=this.calcHighlightColor(N,W)),Q.drawRect(T,S,this.barWidth-1,V-1,N,N)):void 0}}),l.fn.sparkline.discrete=d=H(l.fn.sparkline._base,j,{type:"discrete",init:function(Q,N,O,P,M){d._super.init.call(this,Q,N,O,P,M),this.regionShapes={},this.values=N=l.map(N,Number),this.min=b.min.apply(b,N),this.max=b.max.apply(b,N),this.range=this.max-this.min,this.width=P="auto"===O.get("width")?2*N.length:this.width,this.interval=b.floor(P/N.length),this.itemWidth=P/N.length,O.get("chartRangeMin")!==c&&(O.get("chartRangeClip")||O.get("chartRangeMin")<this.min)&&(this.min=O.get("chartRangeMin")),O.get("chartRangeMax")!==c&&(O.get("chartRangeClip")||O.get("chartRangeMax")>this.max)&&(this.max=O.get("chartRangeMax")),this.initTarget(),this.target&&(this.lineHeight="auto"===O.get("lineHeight")?b.round(0.3*this.canvasHeight):O.get("lineHeight"))},getRegion:function(N,M){return b.floor(M/this.itemWidth)},getCurrentRegionFields:function(){var M=this.currentRegion;return{isNull:this.values[M]===c,value:this.values[M],offset:M}},renderRegion:function(U,P){var N,O,Q,Y,aa=this.values,ab=this.options,R=this.min,X=this.max,T=this.range,M=this.interval,W=this.target,S=this.canvasHeight,Z=this.lineHeight,V=S-Z;return O=E(aa[U],R,X),Y=U*M,N=b.round(V-V*((O-R)/T)),Q=ab.get("thresholdColor")&&O<ab.get("thresholdValue")?ab.get("thresholdColor"):ab.get("lineColor"),P&&(Q=this.calcHighlightColor(Q,ab)),W.drawLine(Y,N,Y,N+Z,Q)}}),l.fn.sparkline.bullet=F=H(l.fn.sparkline._base,{type:"bullet",init:function(S,O,P,R,N){var Q,M,T;F._super.init.call(this,S,O,P,R,N),this.values=O=I(O),T=O.slice(),T[0]=null===T[0]?T[2]:T[0],T[1]=null===O[1]?T[2]:T[1],Q=b.min.apply(b,O),M=b.max.apply(b,O),Q=P.get("base")===c?0>Q?Q:0:P.get("base"),this.min=Q,this.max=M,this.range=M-Q,this.shapes={},this.valueShapes={},this.regiondata={},this.width=R="auto"===P.get("width")?"4.0em":R,this.target=this.$el.simpledraw(R,N,P.get("composite")),O.length||(this.disabled=!0),this.initTarget()},getRegion:function(N,M,P){var O=this.target.getShapeAt(N,M,P);return O!==c&&this.shapes[O]!==c?this.shapes[O]:c},getCurrentRegionFields:function(){var M=this.currentRegion;return{fieldkey:M.substr(0,1),value:this.values[M.substr(1)],region:M}},changeHighlight:function(N){var M,P=this.currentRegion,O=this.valueShapes[P];switch(delete this.shapes[O],P.substr(0,1)){case"r":M=this.renderRange(P.substr(1),N);break;case"p":M=this.renderPerformance(N);break;case"t":M=this.renderTarget(N)}this.valueShapes[P]=M.id,this.shapes[M.id]=P,this.target.replaceWithShape(O,M)},renderRange:function(P,N){var Q=this.values[P],O=b.round(this.canvasWidth*((Q-this.min)/this.range)),M=this.options.get("rangeColors")[P-2];return N&&(M=this.calcHighlightColor(M,this.options)),this.target.drawRect(0,0,O-1,this.canvasHeight-1,M,M)},renderPerformance:function(N){var P=this.values[1],O=b.round(this.canvasWidth*((P-this.min)/this.range)),M=this.options.get("performanceColor");return N&&(M=this.calcHighlightColor(M,this.options)),this.target.drawRect(0,b.round(0.3*this.canvasHeight),O-1,b.round(0.4*this.canvasHeight)-1,M,M)},renderTarget:function(O){var R=this.values[0],M=b.round(this.canvasWidth*((R-this.min)/this.range)-this.options.get("targetWidth")/2),Q=b.round(0.1*this.canvasHeight),P=this.canvasHeight-2*Q,N=this.options.get("targetColor");return O&&(N=this.calcHighlightColor(N,this.options)),this.target.drawRect(M,Q,this.options.get("targetWidth")-1,P-1,N,N)},render:function(){var N,M,P=this.values.length,O=this.target;if(F._super.render.call(this)){for(N=2;P>N;N++){M=this.renderRange(N).append(),this.shapes[M.id]="r"+N,this.valueShapes["r"+N]=M.id}null!==this.values[1]&&(M=this.renderPerformance().append(),this.shapes[M.id]="p1",this.valueShapes.p1=M.id),null!==this.values[0]&&(M=this.renderTarget().append(),this.shapes[M.id]="t0",this.valueShapes.t0=M.id),O.render()}}}),l.fn.sparkline.pie=w=H(l.fn.sparkline._base,{type:"pie",init:function(R,N,O,Q,M){var P,S=0;if(w._super.init.call(this,R,N,O,Q,M),this.shapes={},this.valueShapes={},this.values=N=l.map(N,Number),"auto"===O.get("width")&&(this.width=this.height),N.length>0){for(P=N.length;P--;){S+=N[P]}}this.total=S,this.initTarget(),this.radius=b.floor(b.min(this.canvasWidth,this.canvasHeight)/2)},getRegion:function(N,M,P){var O=this.target.getShapeAt(N,M,P);return O!==c&&this.shapes[O]!==c?this.shapes[O]:c},getCurrentRegionFields:function(){var M=this.currentRegion;return{isNull:this.values[M]===c,value:this.values[M],percent:this.values[M]/this.total*100,color:this.options.get("sliceColors")[M%this.options.get("sliceColors").length],offset:M}},changeHighlight:function(M){var P=this.currentRegion,N=this.renderSlice(P,M),O=this.valueShapes[P];delete this.shapes[O],this.target.replaceWithShape(O,N),this.valueShapes[P]=N.id,this.shapes[N.id]=P},renderSlice:function(W,P){var O,R,T,Z,Q,X=this.target,ab=this.options,V=this.radius,M=ab.get("borderWidth"),S=ab.get("offset"),N=2*b.PI,aa=this.values,Y=this.total,U=S?2*b.PI*(S/360):0;for(Z=aa.length,T=0;Z>T;T++){if(O=U,R=U,Y>0&&(R=U+N*(aa[T]/Y)),W===T){return Q=ab.get("sliceColors")[T%ab.get("sliceColors").length],P&&(Q=this.calcHighlightColor(Q,ab)),X.drawPieSlice(V,V,V-M,O,R,c,Q)}U=R}},render:function(){var P,R,S=this.target,O=this.values,Q=this.options,M=this.radius,N=Q.get("borderWidth");if(w._super.render.call(this)){for(N&&S.drawCircle(M,M,b.floor(M-N/2),Q.get("borderColor"),c,N).append(),R=O.length;R--;){O[R]&&(P=this.renderSlice(R).append(),this.valueShapes[R]=P.id,this.shapes[P.id]=R)}S.render()}}}),l.fn.sparkline.box=q=H(l.fn.sparkline._base,{type:"box",init:function(Q,N,O,P,M){q._super.init.call(this,Q,N,O,P,M),this.values=l.map(N,Number),this.width="auto"===O.get("width")?"4.0em":P,this.initTarget(),this.values.length||(this.disabled=1)},getRegion:function(){return 1},getCurrentRegionFields:function(){var M=[{field:"lq",value:this.quartiles[0]},{field:"med",value:this.quartiles[1]},{field:"uq",value:this.quartiles[2]}];return this.loutlier!==c&&M.push({field:"lo",value:this.loutlier}),this.routlier!==c&&M.push({field:"ro",value:this.routlier}),this.lwhisker!==c&&M.push({field:"lw",value:this.lwhisker}),this.rwhisker!==c&&M.push({field:"rw",value:this.rwhisker}),M},render:function(){var X,ac,Q,W,V,U,M,S,ab,Z,P,af=this.target,O=this.values,T=O.length,R=this.options,ae=this.canvasWidth,N=this.canvasHeight,Y=R.get("chartRangeMin")===c?b.min.apply(b,O):R.get("chartRangeMin"),ad=R.get("chartRangeMax")===c?b.max.apply(b,O):R.get("chartRangeMax"),aa=0;if(q._super.render.call(this)){if(R.get("raw")){R.get("showOutliers")&&O.length>5?(ac=O[0],X=O[1],W=O[2],V=O[3],U=O[4],M=O[5],S=O[6]):(X=O[0],W=O[1],V=O[2],U=O[3],M=O[4])}else{if(O.sort(function(ah,ag){return ah-ag}),W=v(O,1),V=v(O,2),U=v(O,3),Q=U-W,R.get("showOutliers")){for(X=M=c,ab=0;T>ab;ab++){X===c&&O[ab]>W-Q*R.get("outlierIQR")&&(X=O[ab]),O[ab]<U+Q*R.get("outlierIQR")&&(M=O[ab])}ac=O[0],S=O[T-1]}else{X=O[0],M=O[T-1]}}this.quartiles=[W,V,U],this.lwhisker=X,this.rwhisker=M,this.loutlier=ac,this.routlier=S,P=ae/(ad-Y+1),R.get("showOutliers")&&(aa=b.ceil(R.get("spotRadius")),ae-=2*b.ceil(R.get("spotRadius")),P=ae/(ad-Y+1),X>ac&&af.drawCircle((ac-Y)*P+aa,N/2,R.get("spotRadius"),R.get("outlierLineColor"),R.get("outlierFillColor")).append(),S>M&&af.drawCircle((S-Y)*P+aa,N/2,R.get("spotRadius"),R.get("outlierLineColor"),R.get("outlierFillColor")).append()),af.drawRect(b.round((W-Y)*P+aa),b.round(0.1*N),b.round((U-W)*P),b.round(0.8*N),R.get("boxLineColor"),R.get("boxFillColor")).append(),af.drawLine(b.round((X-Y)*P+aa),b.round(N/2),b.round((W-Y)*P+aa),b.round(N/2),R.get("lineColor")).append(),af.drawLine(b.round((X-Y)*P+aa),b.round(N/4),b.round((X-Y)*P+aa),b.round(N-N/4),R.get("whiskerColor")).append(),af.drawLine(b.round((M-Y)*P+aa),b.round(N/2),b.round((U-Y)*P+aa),b.round(N/2),R.get("lineColor")).append(),af.drawLine(b.round((M-Y)*P+aa),b.round(N/4),b.round((M-Y)*P+aa),b.round(N-N/4),R.get("whiskerColor")).append(),af.drawLine(b.round((V-Y)*P+aa),b.round(0.1*N),b.round((V-Y)*P+aa),b.round(0.9*N),R.get("medianColor")).append(),R.get("target")&&(Z=b.ceil(R.get("spotRadius")),af.drawLine(b.round((R.get("target")-Y)*P+aa),b.round(N/2-Z),b.round((R.get("target")-Y)*P+aa),b.round(N/2+Z),R.get("targetColor")).append(),af.drawLine(b.round((R.get("target")-Y)*P+aa-Z),b.round(N/2),b.round((R.get("target")-Y)*P+aa+Z),b.round(N/2),R.get("targetColor")).append()),af.render()}}}),z=H({init:function(O,P,N,M){this.target=O,this.id=P,this.type=N,this.args=M},append:function(){return this.target.appendShape(this),this}}),m=H({_pxregex:/(\d+)(px)?\s*$/i,init:function(N,M,O){N&&(this.width=N,this.height=M,this.target=O,this.lastShapeId=null,O[0]&&(O=O[0]),l.data(O,"_jqs_vcanvas",this))},drawLine:function(O,Q,N,P,R,M){return this.drawShape([[O,Q],[N,P]],R,M)},drawShape:function(O,N,P,M){return this._genShape("Shape",[O,N,P,M])},drawCircle:function(O,R,N,P,Q,M){return this._genShape("Circle",[O,R,N,P,Q,M])},drawPieSlice:function(N,S,M,P,O,Q,R){return this._genShape("PieSlice",[N,S,M,P,O,Q,R])},drawRect:function(N,R,O,M,P,Q){return this._genShape("Rect",[N,R,O,M,P,Q])},getElement:function(){return this.canvas},getLastShapeId:function(){return this.lastShapeId},reset:function(){alert("reset not implemented")},_insert:function(M,N){l(N).html(M)},_calculatePixelDims:function(P,M,O){var N;N=this._pxregex.exec(M),this.pixelHeight=N?N[1]:l(O).height(),N=this._pxregex.exec(P),this.pixelWidth=N?N[1]:l(O).width()},_genShape:function(N,M){var O=i++;return M.unshift(O),new z(this,O,N,M)},appendShape:function(){alert("appendShape not implemented")},replaceWithShape:function(){alert("replaceWithShape not implemented")},insertAfterShape:function(){alert("insertAfterShape not implemented")},removeShapeId:function(){alert("removeShapeId not implemented")},getShapeAt:function(){alert("getShapeAt not implemented")},render:function(){alert("render not implemented")}}),B=H(m,{init:function(O,M,P,N){B._super.init.call(this,O,M,P),this.canvas=a.createElement("canvas"),P[0]&&(P=P[0]),l.data(P,"_jqs_vcanvas",this),l(this.canvas).css({display:"inline-block",width:O,height:M,verticalAlign:"top"}),this._insert(this.canvas,P),this._calculatePixelDims(O,M,this.canvas),this.canvas.width=this.pixelWidth,this.canvas.height=this.pixelHeight,this.interact=N,this.shapes={},this.shapeseq=[],this.currentTargetShapeId=c,l(this.canvas).css({width:this.pixelWidth,height:this.pixelHeight})},_getContext:function(O,P,M){var N=this.canvas.getContext("2d");return O!==c&&(N.strokeStyle=O),N.lineWidth=M===c?1:M,P!==c&&(N.fillStyle=P),N},reset:function(){var M=this._getContext();M.clearRect(0,0,this.pixelWidth,this.pixelHeight),this.shapes={},this.shapeseq=[],this.currentTargetShapeId=c},_drawShape:function(S,R,Q,T,M){var O,P,N=this._getContext(Q,T,M);for(N.beginPath(),N.moveTo(R[0][0]+0.5,R[0][1]+0.5),O=1,P=R.length;P>O;O++){N.lineTo(R[O][0]+0.5,R[O][1]+0.5)}Q!==c&&N.stroke(),T!==c&&N.fill(),this.targetX!==c&&this.targetY!==c&&N.isPointInPath(this.targetX,this.targetY)&&(this.currentTargetShapeId=S)},_drawCircle:function(R,O,T,N,Q,S,M){var P=this._getContext(Q,S,M);P.beginPath(),P.arc(O,T,N,0,2*b.PI,!1),this.targetX!==c&&this.targetY!==c&&P.isPointInPath(this.targetX,this.targetY)&&(this.currentTargetShapeId=R),Q!==c&&P.stroke(),S!==c&&P.fill()},_drawPieSlice:function(Q,U,S,P,R,O,T,N){var M=this._getContext(T,N);M.beginPath(),M.moveTo(U,S),M.arc(U,S,P,R,O,!1),M.lineTo(U,S),M.closePath(),T!==c&&M.stroke(),N&&M.fill(),this.targetX!==c&&this.targetY!==c&&M.isPointInPath(this.targetX,this.targetY)&&(this.currentTargetShapeId=Q)},_drawRect:function(Q,N,S,O,M,P,R){return this._drawShape(Q,[[N,S],[N+O,S],[N+O,S+M],[N,S+M],[N,S]],P,R)},appendShape:function(M){return this.shapes[M.id]=M,this.shapeseq.push(M.id),this.lastShapeId=M.id,M.id},replaceWithShape:function(O,M){var N,P=this.shapeseq;for(this.shapes[M.id]=M,N=P.length;N--;){P[N]==O&&(P[N]=M.id)}delete this.shapes[O]},replaceWithShapes:function(O,N){var M,Q,S,R=this.shapeseq,P={};for(Q=O.length;Q--;){P[O[Q]]=!0}for(Q=R.length;Q--;){M=R[Q],P[M]&&(R.splice(Q,1),delete this.shapes[M],S=Q)}for(Q=N.length;Q--;){R.splice(S,0,N[Q].id),this.shapes[N[Q].id]=N[Q]}},insertAfterShape:function(O,M){var N,P=this.shapeseq;for(N=P.length;N--;){if(P[N]===O){return P.splice(N+1,0,M.id),this.shapes[M.id]=M,void 0}}},removeShapeId:function(N){var M,O=this.shapeseq;for(M=O.length;M--;){if(O[M]===N){O.splice(M,1);break}}delete this.shapes[N]},getShapeAt:function(N,M,O){return this.targetX=M,this.targetY=O,this.render(),this.currentTargetShapeId},render:function(){var R,N,P,S=this.shapeseq,M=this.shapes,Q=S.length,O=this._getContext();for(O.clearRect(0,0,this.pixelWidth,this.pixelHeight),P=0;Q>P;P++){R=S[P],N=M[R],this["_draw"+N.type].apply(this,N.args)}this.interact||(this.shapes={},this.shapeseq=[])}}),y=H(m,{init:function(N,M,P){var O;y._super.init.call(this,N,M,P),P[0]&&(P=P[0]),l.data(P,"_jqs_vcanvas",this),this.canvas=a.createElement("span"),l(this.canvas).css({display:"inline-block",position:"relative",overflow:"hidden",width:N,height:M,margin:"0px",padding:"0px",verticalAlign:"top"}),this._insert(this.canvas,P),this._calculatePixelDims(N,M,this.canvas),this.canvas.width=this.pixelWidth,this.canvas.height=this.pixelHeight,O='<v:group coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'" style="position:absolute;top:0;left:0;width:'+this.pixelWidth+"px;height="+this.pixelHeight+'px;"></v:group>',this.canvas.insertAdjacentHTML("beforeEnd",O),this.group=l(this.canvas).children()[0],this.rendered=!1,this.prerender=""},_drawShape:function(R,Y,U,M,P){var S,W,X,Q,V,N,O,T=[];for(O=0,N=Y.length;N>O;O++){T[O]=""+Y[O][0]+","+Y[O][1]}return S=T.splice(0,1),P=P===c?1:P,W=U===c?' stroked="false" ':' strokeWeight="'+P+'px" strokeColor="'+U+'" ',X=M===c?' filled="false"':' fillColor="'+M+'" filled="true" ',Q=T[0]===T[T.length-1]?"x ":"",V='<v:shape coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'"  id="jqsshape'+R+'" '+W+X+' style="position:absolute;left:0px;top:0px;height:'+this.pixelHeight+"px;width:"+this.pixelWidth+'px;padding:0px;margin:0px;"  path="m '+S+" l "+T.join(", ")+" "+Q+'e"> </v:shape>'},_drawCircle:function(P,S,Q,O,R,M,N){var V,U,T;return S-=O,Q-=O,V=R===c?' stroked="false" ':' strokeWeight="'+N+'px" strokeColor="'+R+'" ',U=M===c?' filled="false"':' fillColor="'+M+'" filled="true" ',T='<v:oval  id="jqsshape'+P+'" '+V+U+' style="position:absolute;top:'+Q+"px; left:"+S+"px; width:"+2*O+"px; height:"+2*O+'px"></v:oval>'},_drawPieSlice:function(T,Y,W,S,U,P,X,O){var V,N,M,R,Q,ab,aa,Z;if(U===P){return""}if(P-U===2*b.PI&&(U=0,P=2*b.PI),N=Y+b.round(b.cos(U)*S),M=W+b.round(b.sin(U)*S),R=Y+b.round(b.cos(P)*S),Q=W+b.round(b.sin(P)*S),N===R&&M===Q){if(P-U<b.PI){return""}N=R=Y+S,M=Q=W}return N===R&&M===Q&&P-U<b.PI?"":(V=[Y-S,W-S,Y+S,W+S,N,M,R,Q],ab=X===c?' stroked="false" ':' strokeWeight="1px" strokeColor="'+X+'" ',aa=O===c?' filled="false"':' fillColor="'+O+'" filled="true" ',Z='<v:shape coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'"  id="jqsshape'+T+'" '+ab+aa+' style="position:absolute;left:0px;top:0px;height:'+this.pixelHeight+"px;width:"+this.pixelWidth+'px;padding:0px;margin:0px;"  path="m '+Y+","+W+" wa "+V.join(", ")+' x e"> </v:shape>')},_drawRect:function(Q,N,S,O,M,P,R){return this._drawShape(Q,[[N,S],[N,S+M],[N+O,S+M],[N+O,S],[N,S]],P,R)},reset:function(){this.group.innerHTML=""},appendShape:function(M){var N=this["_draw"+M.type].apply(this,M.args);return this.rendered?this.group.insertAdjacentHTML("beforeEnd",N):this.prerender+=N,this.lastShapeId=M.id,M.id},replaceWithShape:function(P,M){var O=l("#jqsshape"+P),N=this["_draw"+M.type].apply(this,M.args);O[0].outerHTML=N},replaceWithShapes:function(N,M){var P,Q=l("#jqsshape"+N[0]),O="",R=M.length;for(P=0;R>P;P++){O+=this["_draw"+M[P].type].apply(this,M[P].args)}for(Q[0].outerHTML=O,P=1;P<N.length;P++){l("#jqsshape"+N[P]).remove()}},insertAfterShape:function(P,M){var O=l("#jqsshape"+P),N=this["_draw"+M.type].apply(this,M.args);O[0].insertAdjacentHTML("afterEnd",N)},removeShapeId:function(N){var M=l("#jqsshape"+N);this.group.removeChild(M[0])},getShapeAt:function(M){var N=M.id.substr(8);return N},render:function(){this.rendered||(this.group.innerHTML=this.prerender,this.rendered=!0)}})})}(document,Math);